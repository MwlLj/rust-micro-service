[TOC]

## 一. feature
- 作为注册中心的缓存服务 (缓存微服务的注册信息)
- 使用 nginx 或者 注册中心的方式来对外提供接口
    - nginx: 多个缓存服务注册到nginx中, 对外提供一个网关ip即可
    - 注册中心: 将缓存服务注册到注册中心, 客户端通过注册中心获取需要访问的 缓存服务的地址信息

## 二. 术语说明
1. 微服务: 服务集群中的服务 (配置服务 / 日志服务)
2. 客户端: 当微服务发起请求时, 该微服务可认为是客户端
3. 缓存服务: 做为服务发现的缓存, 为了不让服务发现多次读取数据库
4. 注册中心: 记录微服务的注册中心

## 三. 缓存机制
1. 接收客户端的请求, 从本地内存中获取客户端需要的微服务信息
2. 如果本地内存中不存在客户端请求的微服务信息, 缓存服务将从注册中心获取对应微服务的信息列表
    并缓存到自身内存中
3. 客户端发起一次请求, 就对调用次数加1, 到了一定时间之后将缓存写入注册中心
    写入完成后, 获取注册中心的最新服务信息 (解决注册中心频繁写入的问题)

## 四. 代码构思
1. 客户端请求中带有接收方所处注册中心的类型 (zookeeper / consul / ...)
    这个类型将与服务信息一起发送到缓存服务
2. 注册中心的地址配置, 使用配置文件的方式配置

## 五. 代码结构
1. 读取配置文件, 并根据配置文件创建相应的注册中心register实例 (配置文件中存在的类型才会创建)
    这些register实例, 将由管理者维护, 其他模块通过管理者获取register实例对象
2. 根据配置文件获取接口访问模式(nginx / 注册中心 / ...)
    如果是 注册中心的方式, 那么proto实例被创建时, 应该将自身的信息注册到注册中心
3. 使用不同的协议 (proto) 响应客户端的请求
4. 根据客户端给出的(注册中心类型/服务名称), 从内存中查找是否存在该服务名相对应的实例列表
    如果没有找到: 创建一个 service 对象, 并从注册中心获取该名称的服务列表, 缓存在 service 对象中
5. service 实例维护/更新自身的列表, 并通过register定时更新自身列表到注册中心
    (每次更新注册中心, 都需要先获取, 再用 根据获取到的数值加上自身内存中的数值 更新至注册中心)
